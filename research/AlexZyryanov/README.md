# Определение степени влияния погоды на продажу в магазинах Walmart.

## Гипотеза:

1. Создадим две таблицы признаков: с реальной погодой и "очищенной".
Под "очищенной" погодой условимся считать усреднённую температуру, отсутствие осадков и других метеорологических событий.

2. Обучаем модель на таблице с реальной погодой.

3. Делаем предсказания продаж по обеим таблицам. Записываем их.

4. Делим предсказание продаж по реальной погоде на предсказание по "очищенной" погоде.

Получаем искомый коэффициент. Заодно можно получить разницу, чтобы узнать "насколько больше/меньше товара купили".

## Выбор модели.

Выбрали CatBoost - хорошо справляется с табличными данными с числовыми и категориальными признаками, устойчив к переобучению, умеет объяснять предсказания (SHAP).

## Текущий результат обучению.

Предсказываем колонку `unints`.
Выборка разделена на X_train, X_valid, X_test: 75% / 12.5% / 12.5 %.
Обучаем минимизируя метрику RMSLE.

bestTest = 13.68162667
bestIteration = 2886

Shrink model to first 2887 iterations.
RMSLE on test = 0.5314

Формально результаты выглядат красиво, но практическое применение модели выявило некоторые проблемы, которые мы исправляем.

## Веб интерфейс

http://46.173.214.94:8090/ - сейчас мы в процессе интеграции полученных предсказанных данных для наиболее наглядной их визуализации.

Сейчас мы показываем магазины на карте, отображаем таблицу с предсказаниями.

Остальное в процессе реализации.
