# Зависимость продаж от прогноза погоды (LSTM)

**Описание**
Одну LSTM-модель обучаем на исторических продажах и метеоданных (температура, осадки). Далее экспериментально изменяем погодные признаки в будущем и сравниваем прогнозы с базовым сценарием.

---

## Задача

Оценить, как прогноз температуры и осадков корректирует прогноз продаж магазинов.

## Гипотеза

Различие между предсказаниями модели на базовой погоде и на альтернативном прогнозе показывает влияние метеоусловий на продажи.

## Порядок действий

1. **Подготовка данных**: объединить временные ряды продаж с признаками температуры и осадков.
2. **Обучение**: одна LSTM-модель на полном наборе признаков.
3. **Эксперименты**: подставить различные сценарии прогноза (темп., осадки) в будущем периоде.
4. **Анализ влияния**: вычислить разницу прогнозов:

   ```
   Δ = ŷ(погода_альт) – ŷ(погода_база)
   ```

   и/или относительный коэффициент:

   ```
   k = ŷ(погода_альт) / ŷ(погода_база)
   ```
5. **Коррекция заказов**: на основе Δ или k скорректировать плановые заказы.

## Выбор модели

* **LSTM**: учитывает временную структуру данных и мультизадачность (прогноз на разные горизонты: неделя, месяц, сезон).
* Регуляризация: Dropout в LSTM и на выходе.

## Текущий результат

* Модель обучена, но разница между тренировочной и валидационной ошибкой пока значительна (из‑за регуляризации и небольшого валидационного набора).

### В следующие шаги

1. Отрегулировать Dropout и гиперпараметры.
2. Добавить новые признаки (возможно: скользящие средние, календарные эффекты).
3. Построить **3 отдельные модели**, каждая на свой горизонт прогнозирования (неделя, месяц, сезон).
4. Автоматизировать генерацию альтернативных сценариев погоды и анализ влияния.
